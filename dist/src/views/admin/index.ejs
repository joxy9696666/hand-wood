<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å ‚Äî HandWood</title>
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="stylesheet" href="/styles/admin.css">
    <style>
      /* –°–ü–ï–¶–ò–§–ò–ß–ù–´–ï –°–¢–ò–õ–ò –î–õ–Ø –ì–õ–ê–í–ù–û–ô –°–¢–†–ê–ù–ò–¶–´ –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–ò */

      .menu-toggle {
        display: none;
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: #4A2C1F;
      }

      .topbar-title {
        margin: 0;
        font-size: 1.8rem;
        color: #4A2C1F;
      }

      /* –°–ï–¢–ö–ê –ö–ê–†–¢–û–ß–ï–ö */
      .admin-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .card {
        background: white;
        padding: 2rem;
        border-radius: 12px;
        box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        transition: all 0.3s;
        border-top: 4px solid #8B5E3C;
      }

      .card:hover {
        box-shadow: 0 8px 24px rgba(0,0,0,0.12);
        transform: translateY(-4px);
      }

      .card.stats {
        border-top-color: #D4704A;
      }

      .card-icon {
        font-size: 2.5rem;
        margin-bottom: 1rem;
      }

      .card-title {
        font-size: 1.3rem;
        font-weight: 600;
        color: #4A2C1F;
        margin-bottom: 0.5rem;
      }

      .card-desc {
        color: #666;
        font-size: 0.95rem;
        margin-bottom: 1.5rem;
      }

      .card-stat {
        background: #f5f3f0;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1rem;
      }

      .card-stat-label {
        font-size: 0.85rem;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .card-stat-value {
        font-size: 2.2rem;
        font-weight: 700;
        color: #8B5E3C;
        margin-top: 0.5rem;
      }

      .btn-primary {
        display: inline-block;
        background: linear-gradient(135deg, #8B5E3C 0%, #6B4423 100%);
        color: white;
        padding: 0.8rem 1.8rem;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.3s;
        border: none;
        cursor: pointer;
        width: 100%;
        text-align: center;
      }

      .btn-primary:hover {
        box-shadow: 0 6px 20px rgba(139, 94, 60, 0.3);
        transform: translateY(-2px);
      }

      /* –°–¢–ê–¢–ò–°–¢–ò–ö–ê */
      .stats-section {
        background: white;
        padding: 2rem;
        border-radius: 12px;
        box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        margin-bottom: 2rem;
      }

      .stats-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: #4A2C1F;
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.8rem;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
      }

      .stat-item {
        background: linear-gradient(135deg, #f5f3f0 0%, #ede8e2 100%);
        padding: 1.5rem;
        border-radius: 10px;
        border-left: 4px solid #8B5E3C;
        transition: all 0.3s;
      }

      .stat-item:hover {
        box-shadow: 0 4px 16px rgba(139, 94, 60, 0.15);
      }

      .stat-label {
        font-size: 0.85rem;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 0.5rem;
      }

      .stat-value {
        font-size: 2.5rem;
        font-weight: 700;
        color: #8B5E3C;
      }

      .footer-link {
        text-align: center;
        margin-top: 2rem;
        padding-top: 2rem;
        border-top: 1px solid #e0e0e0;
      }

      .footer-link a {
        color: #8B5E3C;
        text-decoration: none;
        font-weight: 600;
        transition: color 0.3s;
      }

      .footer-link a:hover {
        color: #6B4423;
      }

      /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –í–ï–†–°–ò–Ø */
      @media (max-width: 768px) {
        .admin-sidebar {
          width: 100%;
          position: fixed;
          left: 0;
          top: 0;
          height: 100vh;
          z-index: 1100;
          transform: translateX(-100%);
        }

        .admin-sidebar.visible {
          transform: translateX(0);
        }

        .admin-sidebar.hidden {
          transform: translateX(-100%);
        }

        .admin-main {
          margin-left: 0;
          padding: 1rem;
        }

        .menu-toggle {
          display: block;
        }

        .admin-grid {
          grid-template-columns: 1fr;
        }

        .stats-grid {
          grid-template-columns: 1fr;
        }

        .topbar-title {
          font-size: 1.4rem;
        }

        .card {
          padding: 1.5rem;
        }

        .sidebar-footer {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 0.5rem;
        }

        .sidebar-footer a {
          padding: 0.8rem 0.5rem;
        }

        .admin-topbar {
          padding: 1rem;
          margin-bottom: 1.5rem;
        }
      }

      @media (max-width: 480px) {
        .admin-sidebar {
          width: 90vw;
          max-width: 250px;
          transform: translateX(-100%);
        }

        .admin-sidebar.visible {
          transform: translateX(0);
        }

        .admin-main {
          padding: 0.75rem;
        }

        .topbar-title {
          font-size: 1.2rem;
        }

        .card-title {
          font-size: 1.1rem;
        }

        .stat-value {
          font-size: 2rem;
        }

        .card {
          padding: 1rem;
        }
      }
    </style>
</head>
<body>
    <div class="admin-wrapper">
      <!-- –ë–û–ö–û–í–ê–Ø –ü–ê–ù–ï–õ–¨ -->
      <aside class="admin-sidebar" id="adminSidebar">
        <div class="sidebar-logo">
          <h2>üîê HandWood</h2>
        </div>

        <nav class="sidebar-nav">
          <li><a href="/admin" class="active">üìä –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</a></li>
          <li><a href="/admin/products">üì¶ –¢–æ–≤–∞—Ä—ã</a></li>
          <li><a href="/admin/categories">üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a></li>
        </nav>

        <div class="sidebar-footer">
          <a href="/admin/change-password" class="pwd-btn">üîë –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è</a>
          <a href="/admin/logout" class="logout-btn">üö™ –í—ã—Ö–æ–¥</a>
        </div>
      </aside>

      <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ -->
      <main class="admin-main">
        <!-- –¢–û–ü –ë–ê–† -->
        <div class="admin-topbar">
          <div class="topbar-left">
            <button class="menu-toggle" id="menuToggle" onclick="toggleMenu()">‚ò∞</button>
            <h1 class="topbar-title">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
          </div>
        </div>

        <!-- –ö–ê–†–¢–û–ß–ö–ò –ë–´–°–¢–†–û–ì–û –î–û–°–¢–£–ü–ê -->
        <div class="admin-grid">
          <div class="card">
            <div class="card-icon">üì¶</div>
            <h3 class="card-title">–¢–æ–≤–∞—Ä—ã</h3>
            <p class="card-desc">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</p>
            <div class="card-stat">
              <div class="card-stat-label">–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤</div>
              <div class="card-stat-value"><%= products.length %></div>
            </div>
            <a href="/admin/products" class="btn-primary">–£–ø—Ä–∞–≤–ª—è—Ç—å</a>
          </div>

          <div class="card">
            <div class="card-icon">üìÇ</div>
            <h3 class="card-title">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
            <p class="card-desc">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ —Ç–æ–≤–∞—Ä–æ–≤</p>
            <div class="card-stat">
              <div class="card-stat-label">–í—Å–µ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π</div>
              <div class="card-stat-value"><%= categories.length %></div>
            </div>
            <a href="/admin/categories" class="btn-primary">–£–ø—Ä–∞–≤–ª—è—Ç—å</a>
          </div>

          <div class="card stats">
            <div class="card-icon">üìà</div>
            <h3 class="card-title">–°—Ç–∞—Ç—É—Å</h3>
            <p class="card-desc">–í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—Ç–∞–ª–æ–≥–µ</p>
            <div class="card-stat">
              <div class="card-stat-label">‚ö†Ô∏è –¢–æ–≤–∞—Ä–æ–≤ –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</div>
              <div class="card-stat-value"><%= products.filter(p => !p.category_id).length %></div>
            </div>
            <div class="card-stat">
              <div class="card-stat-label">üì≠ –ü—É—Å—Ç—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π</div>
              <div class="card-stat-value"><%= categories.filter(c => !products.some(p => p.category_id === c.id)).length %></div>
            </div>
          </div>
        </div>

        <!-- –†–ê–°–®–ò–†–ï–ù–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
        <div class="stats-section">
          <div class="stats-title">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞</div>
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-label">üì¶ –ü—Ä–æ–¥—É–∫—Ç—ã</div>
              <div class="stat-value"><%= products.length %></div>
            </div>
            <div class="stat-item">
              <div class="stat-label">üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</div>
              <div class="stat-value"><%= categories.length %></div>
            </div>
            <div class="stat-item">
              <div class="stat-label">‚úÖ –¢–æ–≤–∞—Ä–æ–≤ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π</div>
              <div class="stat-value"><%= products.filter(p => p.category_id).length %></div>
            </div>
            <div class="stat-item">
              <div class="stat-label">üíé –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞</div>
              <div class="stat-value"><%= products.length > 0 ? (products.reduce((sum, p) => sum + p.price, 0) / products.length).toFixed(0) : 0 %>‚ÇΩ</div>
            </div>
          </div>
        </div>

        <div class="footer-link">
          <a href="/">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
        </div>
      </main>
    </div>

    <script>
      function toggleMenu() {
        const sidebar = document.getElementById('adminSidebar');
        sidebar.classList.toggle('visible');
        sidebar.classList.toggle('hidden');
      }

      // –ó–∞–∫—Ä—ã–≤–∞—Ç—å –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –ø—É–Ω–∫—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
      if (window.innerWidth <= 768) {
        document.querySelectorAll('.sidebar-nav a').forEach(link => {
          link.addEventListener('click', () => {
            document.getElementById('adminSidebar').classList.remove('visible');
          });
        });
      }

      // –ó–∞–∫—Ä—ã–≤–∞—Ç—å –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
      document.addEventListener('click', (e) => {
        const sidebar = document.getElementById('adminSidebar');
        const toggle = document.getElementById('menuToggle');
        
        if (window.innerWidth <= 768) {
          if (!sidebar.contains(e.target) && !toggle.contains(e.target)) {
            sidebar.classList.remove('visible');
          }
        }
      });
    </script>
</body>
</html>