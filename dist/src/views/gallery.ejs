<%
  var content = `
    <section class="section gallery-section">
      <div class="container">
        <div class="section-title">
          <h1>–ö–∞—Ç–∞–ª–æ–≥ –∏–∑–¥–µ–ª–∏–π</h1>
          <p class="subtitle">–ì–∞–ª–µ—Ä–µ—è –Ω–∞—à–∏—Ö –ª—É—á—à–∏—Ö —Ä–∞–±–æ—Ç –∏ –ø—Ä–æ–µ–∫—Ç–æ–≤</p>
          <p class="section-description" style="margin-top: 1rem; max-width: 700px; margin-left: auto; margin-right: auto;">
            –ö–∞–∂–¥–æ–µ –∏–∑–¥–µ–ª–∏–µ —Å–æ–∑–¥–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –∫ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤—É –∏ –≤–Ω–∏–º–∞–Ω–∏–µ–º –∫ –¥–µ—Ç–∞–ª—è–º. –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ.
          </p>
        </div>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
        <div class="gallery-categories" role="group" aria-label="–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤">
          <button class="category-btn active" data-category="all" style="font-weight: 600; padding: 0.9rem 2rem; cursor: pointer;">
            <span>üìã –í—Å–µ –∏–∑–¥–µ–ª–∏—è</span>
          </button>` +
          categories.map(category => `
          <a href="/category/${category.id}" class="category-btn category-link" style="text-decoration: none; padding: 0.9rem 2rem; font-weight: 500; display: inline-flex; align-items: center;">
            <span>${category.icon || '‚ú®'} ${category.name}</span>
          </a>`).join('') + `
        </div>

        <!-- –°–µ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ -->
        <div class="gallery-grid" role="region" aria-label="–ì–∞–ª–µ—Ä–µ—è —Ç–æ–≤–∞—Ä–æ–≤">` +
          products.map(product => `
            <a href="/product/${product.id}" class="gallery-item-link" title="${product.name}">
              <div class="gallery-item" data-category="${product.category_id || ''}" role="article">
                <div class="gallery-item-image">
                  <picture>
                    ${product.image_path ?
                      `<source 
                         data-srcset="${product.image_path}?w=800&q=80&fm=webp" 
                         type="image/webp">
                       <img 
                         src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='400 300'%3E%3C/svg%3E"
                         data-src="${product.image_path}?w=800&q=80" 
                         alt="${product.name}" 
                         class="lazy-img"
                         loading="lazy"
                         width="400"
                         height="300">` :
                      `<source 
                         data-srcset="https://via.placeholder.com/400x300.webp" 
                         type="image/webp">
                       <img 
                         src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='400 300'%3E%3C/svg%3E"
                         data-src="https://via.placeholder.com/400x300?text=${encodeURIComponent(product.name)}" 
                         alt="${product.name}" 
                         class="lazy-img"
                         loading="lazy"
                         width="400"
                         height="300">`
                    }
                  </picture>
                  <div class="gallery-item-overlay">
                    <span class="gallery-item-action">–ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí</span>
                  </div>
                </div>
                <div class="gallery-item-content">
                  <h3 class="gallery-item-title">${product.name}</h3>
                  ${product.description ? `<p class="gallery-item-description">${product.description}</p>` : ''}
                  <div class="gallery-item-meta">
                    ${product.price ? `<p class="gallery-item-price" style="color: var(--color-accent-warm); font-weight: 600; margin-bottom: 0.4rem;">${product.price} ‚ÇΩ</p>` : ''}
                    ${product.category_name ? `<p class="gallery-item-category" style="font-size: 0.85rem; color: var(--color-text-secondary);">${product.category_name}</p>` : ''}
                  </div>
                </div>
              </div>
            </a>
          `).join('') + `
        </div>
      </div>
    </section>

    <script>
      // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
      const filterBtn = document.querySelector('.category-btn[data-category="all"]');
      if (filterBtn) {
        filterBtn.addEventListener('click', function() {
          document.querySelectorAll('.gallery-item').forEach(item => {
            item.parentElement.style.display = 'block';
            item.parentElement.style.animation = 'fadeInUp 0.5s ease-out';
          });
        });
      }

      // Lazy loading –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
      if (window.lazyLoadUtils && window.lazyLoadUtils.updateLazyLoading) {
        document.addEventListener('DOMContentLoaded', function() {
          setTimeout(() => {
            window.lazyLoadUtils.updateLazyLoading();
          }, 100);
        });
      }
    </script>
  `;
%>
<%- include('layouts/main', { title: '–ö–∞—Ç–∞–ª–æ–≥ –∏–∑–¥–µ–ª–∏–π ‚Äî HandWood', description: '–ì–∞–ª–µ—Ä–µ—è —Ä–∞–±–æ—Ç: –∏–∑–¥–µ–ª–∏—è –∏–∑ –¥–µ—Ä–µ–≤–∞, –º–µ—Ç–∞–ª–ª–∞ –∏ 3D-–ø–µ—á–∞—Ç–∏.', content }) %>