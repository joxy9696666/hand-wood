<% 
  var content = `
    <section class="section order-section">
      <div class="container">
        <div class="section-title">
          <h1>–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</h1>
          <p class="subtitle">–û—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –º—ã —Å–≤—è–∂–µ–º—Å—è –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è</p>
          <p class="section-description" style="margin-top: 1rem; max-width: 700px; margin-left: auto; margin-right: auto;">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É —Å –¥–µ—Ç–∞–ª—è–º–∏ –≤–∞—à–µ–≥–æ –∑–∞–∫–∞–∑–∞, –∏ –Ω–∞—à–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã –ø—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É—é—Ç –≤–∞—Å –ø–æ –∫–∞–∂–¥–æ–º—É –≤–æ–ø—Ä–æ—Å—É.</p>
        </div>
        
        <div style="max-width: 700px; margin: 0 auto;">
          <form id="order-form" action="/api/order" method="POST" class="order-form">
            <fieldset class="form-group">
              <legend style="display: none;">–ó–∞–∫–∞–∑ –∏–∑–¥–µ–ª–∏—è</legend>
              
              <div class="form-field">
                <label for="name">–í–∞—à–µ –∏–º—è <span class="form-required">*</span></label>
                <input 
                  type="text" 
                  id="name" 
                  name="name" 
                  required 
                  placeholder="–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"
                  aria-label="–í–∞—à–µ –∏–º—è"
                  aria-required="true">
              </div>

              <div class="form-field">
                <label for="phone">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ <span class="form-required">*</span></label>
                <input 
                  type="tel" 
                  id="phone" 
                  name="phone" 
                  required 
                  placeholder="+373 22 123456"
                  aria-label="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞"
                  aria-required="true"
                  aria-describedby="phone-hint">
                <small id="phone-hint">–ù–∞–ø—Ä–∏–º–µ—Ä: +373 22 123456</small>
              </div>

              <div class="form-field">
                <label for="email">Email</label>
                <input 
                  type="email" 
                  id="email" 
                  name="email" 
                  placeholder="your@email.com"
                  aria-label="–í–∞—à email">
              </div>

              <div class="form-field">
                <label for="subject">–¢–µ–º–∞ –∑–∞–∫–∞–∑–∞ <span class="form-required">*</span></label>
                <select 
                  id="subject" 
                  name="subject" 
                  required
                  aria-label="–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é"
                  aria-required="true">
                  <option value="">‚Äî –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é ‚Äî</option>
                  <option value="wood">ü™µ –ò–∑–¥–µ–ª–∏—è –∏–∑ –¥–µ—Ä–µ–≤–∞</option>
                  <option value="icons">‚õ™ –ò–∫–æ–Ω—ã –∏ –∫—É–ª—å—Ç—É—Ä–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è</option>
                  <option value="forging">‚öôÔ∏è –•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–æ–≤–∫–∞</option>
                  <option value="3d">üñ®Ô∏è 3D-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
                  <option value="custom">üé® –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç</option>
                  <option value="partnership">ü§ù B2B —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ</option>
                  <option value="other">‚ûï –î—Ä—É–≥–æ–µ</option>
                </select>
              </div>

              <div class="form-field">
                <label for="message">–û–ø–∏—Å–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ <span class="form-required">*</span></label>
                <textarea 
                  id="message" 
                  name="message" 
                  rows="6" 
                  required
                  placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–π –∏–¥–µ–µ, –∂–µ–ª–∞–µ–º—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞—Ö —Ç–æ–≤–∞—Ä–∞, —Å—Ä–æ–∫–∞—Ö –∏ –±—é–¥–∂–µ—Ç–µ..."
                  aria-label="–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞"
                  aria-required="true"></textarea>
              </div>

              <button type="submit" class="btn-primary form-submit">
                <span>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</span>
              </button>

              <p class="form-hint">
                <span class="form-required">*</span> ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
              </p>
            </fieldset>
          </form>

          <div class="order-contacts">
            <h3>–ò–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –Ω–∞–ø—Ä—è–º—É—é</h3>
            <p class="section-description">
              –í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–±—â–µ–Ω–∏—è:
            </p>
            <div class="social-icons order-social">
              <a href="https://api.whatsapp.com/send/?phone=37360860100&text&type=phone_number&app_absent=0" target="_blank" rel="noopener noreferrer" title="–ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –≤ WhatsApp"><img src="/icons/whatsapp.svg" alt="WhatsApp"></a>
              <a href="viber://chat?number=%2B37360860100" target="_blank" rel="noopener noreferrer" title="–°–≤—è–∂–∏—Ç–µ—Å—å —á–µ—Ä–µ–∑ Viber"><img src="/icons/viber.svg" alt="Viber"></a>
              <a href="https://t.me/Hand_Wood_MD" target="_blank" rel="noopener noreferrer" title="–ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –≤ Telegram"><img src="/icons/telegram.svg" alt="Telegram"></a>
              <a href="https://www.instagram.com/handwoodmd?igsh=dXIwM2x3b2w3bGg3" target="_blank" rel="noopener noreferrer" title="–ü–æ—Å–µ—Ç–∏—Ç–µ –Ω–∞—à Instagram"><img src="/icons/instagram.svg" alt="Instagram"></a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <script>
      const form = document.getElementById('order-form');
      const inputs = form.querySelectorAll('input, textarea, select');
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è —Ñ–æ—Ä–º—ã
      inputs.forEach(input => {
        const savedValue = localStorage.getItem('form_' + input.name);
        if (savedValue) input.value = savedValue;
        
        input.addEventListener('change', () => {
          localStorage.setItem('form_' + input.name, input.value);
        });
      });
      
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
      form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const formData = new FormData(this);
        const submitBtn = this.querySelector('button[type="submit"]');
        const originalText = submitBtn.innerHTML;
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
        const name = formData.get('name')?.trim();
        const phone = formData.get('phone')?.trim();
        const message = formData.get('message')?.trim();
        const subject = formData.get('subject')?.trim();
        
        if (!name || name.length < 2) {
          alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è (–º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞)');
          return;
        }
        
        if (!phone) {
          alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞');
          return;
        }
        
        if (!subject) {
          alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É –∑–∞–∫–∞–∑–∞');
          return;
        }
        
        if (!message || message.length < 10) {
          alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤)');
          return;
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
        submitBtn.innerHTML = '<span>–û—Ç–ø—Ä–∞–≤–∫–∞...</span>';
        submitBtn.disabled = true;
        
        try {
          const response = await fetch('/api/order', {
            method: 'POST',
            body: formData
          });
          
          const result = await response.json();
          
          if (result.success) {
            alert(result.message || '–°–ø–∞—Å–∏–±–æ! –í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ. –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.');
            this.reset();
            // –û—á–∏—â–∞–µ–º localStorage
            inputs.forEach(input => {
              localStorage.removeItem('form_' + input.name);
            });
          } else {
            alert('–û—à–∏–±–∫–∞: ' + (result.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ'));
          }
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞:', error);
          alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –≤ WhatsApp.');
        } finally {
          submitBtn.innerHTML = originalText;
          submitBtn.disabled = false;
        }
      });
    </script>
  `;
%>

<%- include('layouts/main', { title: '–ó–∞–∫–∞–∑–∞—Ç—å –∏–∑–¥–µ–ª–∏–µ ‚Äî HandWood', description: '–§–æ—Ä–º–∞ –∑–∞–∫–∞–∑–∞ –∏–∑–¥–µ–ª–∏–π –∏–∑ –¥–µ—Ä–µ–≤–∞, –º–µ—Ç–∞–ª–ª–∞ –∏ 3D-–ø–µ—á–∞—Ç–∏', content: content }) %>
